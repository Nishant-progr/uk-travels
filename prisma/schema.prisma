generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id            String    @id @default(cuid())
  name          String?
  email         String    @unique
  emailVerified DateTime?
  image         String?
  password      String?
  role          String    @default("user")
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  
  bookings      Booking[]
  accounts      Account[]
  sessions      Session[]
}

model Account {
  id                String  @id @default(cuid())
  userId            String
  type              String
  provider          String
  providerAccountId String
  refresh_token     String?
  access_token      String?
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String?
  session_state     String?

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       String
  expires      DateTime
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
}

model Booking {
  id            String   @id @default(cuid())
  userId        String?
  tourId        String?
  firstName     String
  lastName      String
  email         String
  phone         String
  destination   String
  tourName      String
  startDate     DateTime
  endDate       DateTime?
  numberOfGuests Int
  specialRequests String?
  totalPrice    Float?
  paymentStatus String   @default("pending")
  status        String   @default("pending")
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  
  user          User?    @relation(fields: [userId], references: [id])
  tour          Tour?    @relation(fields: [tourId], references: [id])
}

model ContactSubmission {
  id        String   @id @default(cuid())
  name      String
  email     String
  subject   String?
  message   String
  status    String   @default("new")
  createdAt DateTime @default(now())
}

model NewsletterSubscriber {
  id          String   @id @default(cuid())
  email       String   @unique
  name        String?
  subscribed  Boolean  @default(true)
  subscribedAt DateTime @default(now())
  unsubscribedAt DateTime?
}

model Tour {
  id              String   @id @default(cuid())
  name            String
  slug            String   @unique
  description     String
  shortDescription String?
  duration        Int
  maxGroupSize    Int?
  difficulty      String?
  destination     String
  locations       String?
  price           Float
  discountPrice   Float?
  startDates      String?
  image           String?
  gallery         String?
  included        String?
  notIncluded     String?
  metaTitle       String?
  metaDescription String?
  rating          Float?   @default(5.0)
  reviewCount     Int?     @default(0)
  featured        Boolean  @default(false)
  active          Boolean  @default(true)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  bookings        Booking[]
  reviews         Review[]
}

model Destination {
  id              String   @id @default(cuid())
  name            String
  slug            String   @unique
  country         String
  description     String
  shortDescription String?
  image           String?
  coverImage      String?
  gallery         String?
  bestTimeToVisit String?
  attractions     String?
  metaTitle       String?
  metaDescription String?
  featured        Boolean  @default(false)
  active          Boolean  @default(true)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}

model BlogPost {
  id              String   @id @default(cuid())
  title           String
  slug            String   @unique
  excerpt         String?
  content         String
  featuredImage   String?
  category        String?
  tags            String?
  author          String   @default("UK Travels Team")
  authorImage     String?
  metaTitle       String?
  metaDescription String?
  views           Int      @default(0)
  published       Boolean  @default(false)
  publishedAt     DateTime?
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}

model Testimonial {
  id          String   @id @default(cuid())
  name        String
  location    String?
  email       String?
  rating      Int      @default(5)
  text        String
  tourName    String?
  image       String?
  approved    Boolean  @default(false)
  featured    Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Review {
  id          String   @id @default(cuid())
  tourId      String
  userId      String?
  name        String
  email       String?
  rating      Int
  title       String?
  comment     String
  approved    Boolean  @default(false)
  helpful     Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  tour        Tour     @relation(fields: [tourId], references: [id], onDelete: Cascade)
}

model GalleryImage {
  id          String   @id @default(cuid())
  title       String?
  description String?
  imageUrl    String
  category    String?
  location    String?
  featured    Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}
